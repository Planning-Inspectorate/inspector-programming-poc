{% extends "views/layouts/main.njk" %}

{% from "govuk/components/table/macro.njk" import govukTable %}
{% from "govuk/components/tabs/macro.njk" import govukTabs %}

{% block pageContent %}

    {% set caseRows = [] %}

    {% for c in cases %}
        {% set caseRows = (caseRows.push([
            {
                text: c.caseId
            },
            {
                text: c.caseType
            },
            {
                text: c.lpaCode
            },
            {
                text: c.siteAddressPostcode
            },
            {
                text: c.caseProcedure
            },
            {
                text: c.allocationBand
            },
            {
                text: c.allocationLevel
            },
            {
                text: c.caseSpecialisms
            },
            {
                html: '<a href="' + c.reference + '" class="govuk-link">Assign</a>'
            }
        ]), caseRows) %}
    {% endfor %}

    {% set casesTable %}
        {{ govukTable({
            head: [
                {
                    text: "Reference"
                },
                {
                    text: "Type"
                },
                {
                    text: "LPA"
                },
                {
                    text: "Location"
                },
                {
                    text: "Procedure"
                },
                {
                    text: "Allocation band"
                },
                {
                    text: "Allocation level"
                },
                {
                    text: "Assigned"
                },
                {
                    text: "Action"
                }
            ],
            rows: caseRows
        }) }}
    {% endset -%}


    {% set inspectorRows = [] %}

    {% for inspector in inspectors %}
        {% set inspectorRows = (inspectorRows.push([
            {
                text: inspector.firstName + " " + inspector.lastName
            },
            {
                text: inspector.emailAddress
            },
            {
                text: inspector.address.postcode
            },
            {
                text: inspector.grade
            },
            {
                text: inspector.fte
            },
            {
                text: inspector.inspectorManager
            },
            {
                text: inspector.chartingOfficerId
            },
            {
                text: inspector.specialisms
            },
            {
                text: inspector.preclusions
            },
            {
                html: '<a href="' + inspector.id + '" class="govuk-link">Assign</a>'
            }
        ]), inspectorRows) %}
    {% endfor %}

    {% set inspectorsTable %}
        {{ govukTable({
            head: [
                {
                    text: "Name"
                },
                {
                    text: "Email"
                },
                {
                    text: "Location"
                },
                {
                    text: "Grade"
                },
                {
                    text: "FTE"
                },
                {
                    text: "Is Manager"
                },
                {
                    text: "Charting Officer ID"
                },
                {
                    text: "Specialisms"
                },
                {
                    text: "Preclusions"
                },
                {
                    text: "Action"
                }
            ],
            rows: inspectorRows
        }) }}
    {% endset -%}


    {{ govukTabs({
        items: [
            {
                label: "Cases",
                id: "cases",
                panel: {
                    html: casesTable
                }
            },
            {
                label: "Inspectors",
                id: "inspectors",
                panel: {
                    html: inspectorsTable
                }
            }
        ]
    }) }}
{% endblock %}